@startuml C3
title New Generation NFL Fantasy â€” Diagrama de Componentes (C3)

skinparam dpi 140
skinparam rectangle {
  RoundCorner 12
}
skinparam packageStyle rectangle
skinparam linetype ortho
skinparam nodesep 15
skinparam ranksep 25
left to right direction

actor "Usuario / Visitante" as Usuario
actor "Admin / Soporte" as Admin

package "Frontend (React/Next.js)" #LightBlue {
  component "UI Usuario" as UIUser
  component "UI Admin" as UIAdmin
  component "HTTP Client" as UIAPI
}

package "Backend API (FastAPI)" #LightCyan {
  
  package "API Layer" as APILayer #AliceBlue {
    component "UsuariosRouter" as UsuariosRouter
    component "EquiposRouter" as EquiposRouter  
    component "LigasRouter" as LigasRouter
    component "TemporadasRouter" as TemporadasRouter
    component "MediaRouter" as MediaRouter
  }

  package "Validation Layer" as ValidationLayer #LightYellow {
    component "UsuarioValidator" as UserValidator
    component "EquipoNFLValidator" as NFLValidator
    component "EquipoFantasyValidator" as FantasyValidator
    component "LigaValidator" as LigaValidator
    component "TemporadaValidator" as TemporadaValidator
    component "MediaValidator" as MediaValidator
    component "JugadorValidator" as JugadorValidator
  }

  package "Business Logic" as BusinessLayer #LightGreen {
    component "AuthService" as Auth
    component "UsuarioService" as Users
    component "EquipoService" as EquipoSvc
    component "LigaService" as LigaSvc
    component "TemporadaService" as TemporadaSvc
    component "MediaService" as MediaSvc
  }

  package "Supporting Services" as SupportingServices #Lavender {
    component "EmailService" as Notify
    component "NFLService" as NFLSvc
    component "ChatGPTService" as ChatGPTSvc
    component "AnalyticsService" as AnalyticsSvc
  }

  package "Data Access" as DataLayer #LightPink {
    component "UsuarioRepository" as UserRepo
    component "LigaRepository" as LigaRepo
    component "EquipoRepository" as EquipoRepo
    component "TemporadaRepository" as TemporadaRepo
    component "MediaRepository" as MediaRepo
  }
}

package "External Services" #HoneyDew {
  component "NFL API" as NFL
  component "OpenAI API" as ChatGPT
  component "Email Service" as Mail
  component "CDN Storage" as CDN
}

database "PostgreSQL" as DB

'User Interactions
Usuario --> UIUser : "Web access"
Admin --> UIAdmin : "Admin panel"

'Frontend Flow
UIUser --> UIAPI : "HTTP calls"
UIAdmin --> UIAPI : "Admin calls"
UIAPI --> APILayer : "REST API"

'API to Business Logic
UsuariosRouter --> Users : "User operations"
EquiposRouter --> EquipoSvc : "Team operations"
LigasRouter --> LigaSvc : "League operations"
TemporadasRouter --> TemporadaSvc : "Season operations"
MediaRouter --> MediaSvc : "Media operations"
UsuariosRouter --> Auth : "Authentication"

'Validation Flow
Users --> UserValidator : "Validate user rules"
EquipoSvc --> NFLValidator : "Validate NFL teams"
EquipoSvc --> FantasyValidator : "Validate fantasy teams"
LigaSvc --> LigaValidator : "Validate leagues"
TemporadaSvc --> TemporadaValidator : "Validate seasons"
MediaSvc --> MediaValidator : "Validate media"

'Data Access
Auth --> UserRepo : "User data"
Users --> UserRepo : "CRUD operations"
EquipoSvc --> EquipoRepo : "Team data"
LigaSvc --> LigaRepo : "League data"
TemporadaSvc --> TemporadaRepo : "Season data"
MediaSvc --> MediaRepo : "Media data"

'Repository to Database
UserRepo --> DB : "SQL queries"
LigaRepo --> DB : "SQL queries"
EquipoRepo --> DB : "SQL queries"
TemporadaRepo --> DB : "SQL queries"
MediaRepo --> DB : "SQL queries"

'External Integrations
Users --> Notify : "Send emails"
EquipoSvc --> NFLSvc : "NFL data"
EquipoSvc --> ChatGPTSvc : "AI recommendations"
LigaSvc --> NFLSvc : "League stats"
LigaSvc --> AnalyticsSvc : "Analytics"
EquipoSvc --> AnalyticsSvc : "Performance"
AnalyticsSvc --> ChatGPTSvc : "AI insights"

'External API Connections
NFLSvc --> NFL : "Real-time data"
ChatGPTSvc --> ChatGPT : "AI analysis"
Notify --> Mail : "Email delivery"
MediaSvc --> CDN : "File storage"

legend top left
  |**API Layer** - HTTP endpoints |
  |**Validation** - Business rules |
  |**Business Logic** - Core operations |
  |**Supporting** - External integrations |
  |**Data Access** - Repository pattern |
  |**External** - Third-party services |
endlegend


@enduml
